{
  "metadata": {
    "description": "Executes a parsed canvas command on the graph canvas. Returns execution status.",
    "inputs": {
      "vertical": {},
      "horizontal": {
        "input_1": "The parsed command (may be wrapped) with 'type' and 'params' fields."
      }
    },
    "outputs": {
      "type": "Status",
      "description": "A dict with 'success' boolean and 'data' containing any result data."
    }
  },
  "env_spec": {
    "tools": [
      {
        "tool_name": "canvas",
        "affordances": [
          {
            "affordance_name": "execute_command",
            "call_code": "result = tool.execute_command"
          }
        ]
      },
      {
        "tool_name": "composition_tool",
        "affordances": [
          {
            "affordance_name": "compose",
            "call_code": "result = tool.compose(plan=params['plan'], return_key=params.get('return_key'))"
          }
        ]
      },
      {
        "tool_name": "formatter_tool",
        "affordances": [
          {
            "affordance_name": "get",
            "call_code": "result = tool.get"
          },
          {
            "affordance_name": "wrap",
            "call_code": "result = tool.wrap"
          },
          {
            "affordance_name": "parse",
            "call_code": "result = tool.parse"
          }
        ]
      },
      {
        "tool_name": "perception_router",
        "affordances": [
          {
            "affordance_name": "unwrap",
            "call_code": "result = tool.strip_sign"
          }
        ]
      }
    ]
  },
  "sequence_spec": {
    "steps": [
      {
        "step_index": 1,
        "affordance": "formatter_tool.get",
        "params": {},
        "result_key": "dict_get_fn"
      },
      {
        "step_index": 2,
        "affordance": "perception_router.unwrap",
        "params": {},
        "result_key": "unwrap_fn"
      },
      {
        "step_index": 3,
        "affordance": "formatter_tool.parse",
        "params": {},
        "result_key": "parse_fn"
      },
      {
        "step_index": 4,
        "affordance": "canvas.execute_command",
        "params": {},
        "result_key": "execute_fn"
      },
      {
        "step_index": 5,
        "affordance": "formatter_tool.wrap",
        "params": {},
        "result_key": "wrap_fn"
      },
      {
        "step_index": 6,
        "affordance": "composition_tool.compose",
        "params": {
          "plan": [
            {
              "output_key": "wrapped_command",
              "function": {
                "__type__": "MetaValue",
                "key": "dict_get_fn"
              },
              "params": {
                "dictionary": "__initial_input__"
              },
              "literal_params": {
                "key": "input_1"
              }
            },
            {
              "output_key": "command_string",
              "function": {
                "__type__": "MetaValue",
                "key": "unwrap_fn"
              },
              "params": {
                "__positional__": "wrapped_command"
              }
            },
            {
              "output_key": "command",
              "function": {
                "__type__": "MetaValue",
                "key": "parse_fn"
              },
              "params": {
                "__positional__": "command_string"
              }
            },
            {
              "output_key": "command_type",
              "function": {
                "__type__": "MetaValue",
                "key": "dict_get_fn"
              },
              "params": {
                "dictionary": "command"
              },
              "literal_params": {
                "key": "type"
              }
            },
            {
              "output_key": "command_params",
              "function": {
                "__type__": "MetaValue",
                "key": "dict_get_fn"
              },
              "params": {
                "dictionary": "command"
              },
              "literal_params": {
                "key": "params"
              }
            },
            {
              "output_key": "execution_result",
              "function": {
                "__type__": "MetaValue",
                "key": "execute_fn"
              },
              "params": {
                "command_type": "command_type",
                "command_params": "command_params"
              }
            },
            {
              "output_key": "wrapped_result",
              "function": {
                "__type__": "MetaValue",
                "key": "wrap_fn"
              },
              "params": {
                "__positional__": "execution_result"
              },
              "literal_params": {
                "type": "literal"
              }
            }
          ],
          "return_key": "wrapped_result"
        },
        "result_key": "instruction_fn"
      }
    ]
  }
}
