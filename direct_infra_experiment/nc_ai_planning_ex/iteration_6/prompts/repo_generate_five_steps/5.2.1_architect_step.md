# Step 1: Architecture & Tool Selection (The Architect) - Single Inference Unit

**Role:** You are the Lead Architect for a NormCode execution plan. Your job is to transform an abstract "Inference Unit" into a concrete "Execution Specification" by selecting the exact tools (Paradigms) and resources (Prompts/Scripts) required.

**Input:**
1.  **Inference Unit:** A single JSON object from the `.nci.json` array (containing `concept_to_infer`, `function_concept`, and `value_concepts`).
2.  **Paradigms:** A library of available declarative function paradigms (`infra/_agent/_models/_paradigms/README.md`).
3.  **Context:** The implementation task description.

**Objective:**
Return the **exact same Inference Unit JSON**, but **enriched** with `attached_comments` inside the `function_concept` object. These comments must define the Paradigm and Resources.

---

## Instructions

### 1. Analyze the Abstract Function
Look at `function_concept.nc_main`. Does it contain an abstract placeholder like `{paradigm}`?
*   *Example:* `<: :%(Composition):{paradigm}(...)`

### 2. Select Paradigm
Choose the **exact filename** of the paradigm from the library that best fits the intent of this inference step, based on the Context.
*   *Abstract Intent:* "Confirm instruction using a prompt and save the result."
*   *Selected Paradigm:* `h_PromptTemplateInputOther_SaveDir-c_GenerateThinkJson-Extract-Save-o_FileLocation`

### 3. Define Resources
Identify the necessary resource files based on the chosen paradigm's inputs:
*   **Prompts:** If the paradigm requires a prompt, assign a specific file path (e.g., `prompts/1.1_instruction_distillation.md`).
*   **Scripts:** If the paradigm executes code, assign a script path.
*   **Output Paths:** Define where the results should be saved.

### 4. Enrich the JSON
Add strings to the `attached_comments` array inside `function_concept`. Use the standard metadata syntax:
*   `| %{paradigm}: <PARADIGM_NAME_WITHOUT_EXTENSION>`
*   `| %{prompt_location}: <PATH_TO_PROMPT>`
*   `| %{script_location}: <PATH_TO_SCRIPT>`
*   `| %{location_string}: <OUTPUT_PATH>`

### Example Transformation

**Input (Single Inference Unit):**
```json
{
  "concept_to_infer": { ... },
  "function_concept": {
    "flow_index": "1.2.2.1",
    "nc_main": "<= :%(Composition):{paradigm}(...)",
    "attached_comments": []
  },
  "value_concepts": [ ... ]
}
```

**Output (Enriched Unit):**
```json
{
  "concept_to_infer": { ... },
  "function_concept": {
    "flow_index": "1.2.2.1",
    "nc_main": "<= :%(Composition):{paradigm}(...)",
    "attached_comments": [
      "| %{paradigm}: h_PromptTemplateInputOther_SaveDir-c_GenerateThinkJson-Extract-Save-o_FileLocation",
      "| %{prompt_location}: prompts/1.1_instruction_distillation.md",
      "| %{location_string}: next_iteration/"
    ]
  },
  "value_concepts": [ ... ]
}
```

**Deliverable:** Return ONLY the single valid JSON object for the Enriched Inference Unit.
